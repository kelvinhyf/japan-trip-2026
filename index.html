<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä¼Šè±†ç®±æ ¹ 5å¤©4å¤œè‡ªé§•éŠ</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Leaflet CSS & JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; -webkit-tap-highlight-color: transparent; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* æ‰‹æ©Ÿç‰ˆä½ˆå±€è¨­å®š */
        @media (max-width: 768px) {
            #app { flex-direction: column; }
            /* åœ°åœ–åœ¨ä¸Šæ–¹ï¼Œé«˜åº¦ä½” 35vh */
            .map-section { height: 35vh !important; order: 1; }
            /* è¡Œç¨‹è¡¨åœ¨ä¸‹æ–¹ï¼Œé«˜åº¦ä½” 65vh */
            .list-section { height: 65vh !important; order: 2; border-radius: 20px 20px 0 0; margin-top: -15px; z-index: 10; position: relative; box-shadow: 0 -4px 10px rgba(0,0,0,0.1); }
            /* åº•éƒ¨ç·©è¡å€ï¼Œé˜²æ­¢è¢«é®æ“‹ */
            .events-container { padding-bottom: 150px !important; }
        }

        /* é›»è…¦ç‰ˆä½ˆå±€è¨­å®š */
        @media (min-width: 769px) {
            #app { flex-direction: row; }
            .map-section { height: 100vh !important; width: 60%; order: 2; }
            .list-section { height: 100vh !important; width: 40%; max-width: 450px; order: 1; z-index: 10; }
        }
    </style>
</head>
<body class="bg-gray-100 h-screen overflow-hidden">

    <div id="app" class="flex w-full h-full relative">
        
        <!-- å·¦å´ (æ‰‹æ©Ÿç‚ºä¸‹å´)ï¼šè¡Œç¨‹åˆ—è¡¨ -->
        <div class="list-section bg-white shadow-xl flex flex-col w-full h-full">
            <!-- Header -->
            <div class="bg-blue-600 text-white p-3 shrink-0 flex justify-between items-center shadow-md z-20 rounded-t-[20px] md:rounded-none">
                <div>
                    <h1 class="text-lg font-bold">ğŸ‡¯ğŸ‡µ ä¼Šè±†ç®±æ ¹è‡ªé§•</h1>
                    <p class="text-xs opacity-90">2026/01/31 - 02/04</p>
                </div>
                <div class="bg-blue-700 px-2 py-1 rounded text-sm font-bold">Day {{ currentDay + 1 }}</div>
            </div>

            <!-- Tabs -->
            <div class="flex overflow-x-auto bg-gray-50 border-b shrink-0 scrollbar-hide z-20">
                <button 
                    v-for="(day, index) in itinerary" 
                    :key="index"
                    @click="currentDay = index"
                    :class="['px-4 py-3 whitespace-nowrap text-xs font-bold transition-colors', 
                             currentDay === index ? 'text-blue-600 border-b-2 border-blue-600 bg-white' : 'text-gray-500 hover:bg-gray-100']">
                    {{ day.shortTitle || day.title.split(' ')[0] + ' ' + day.title.split(' ')[1] }}
                </button>
            </div>

            <!-- é‡é»æç¤º -->
            <div class="p-3 bg-amber-50 border-b border-amber-100 shrink-0 text-xs text-amber-900 leading-relaxed flex gap-2">
                <span class="text-lg">ğŸ’¡</span>
                <span>{{ itinerary[currentDay].summary }}</span>
            </div>

            <!-- Timeline Content (å¢åŠ  padding-bottom) -->
            <div class="events-container flex-1 overflow-y-auto p-4 space-y-6 bg-white">
                <div v-for="(item, idx) in itinerary[currentDay].events" :key="idx" 
                     class="relative pl-5 border-l-2 border-gray-100">
                    
                    <!-- åœ“é» -->
                    <div :class="['absolute -left-[7px] top-1 w-3.5 h-3.5 rounded-full border-2 bg-white', item.highlight ? 'border-red-500 shadow-sm' : 'border-blue-500']"></div>
                    
                    <div class="mb-1 flex items-baseline gap-2">
                        <span :class="['font-bold font-mono text-base', item.highlight ? 'text-red-600' : 'text-blue-700']">{{ item.time }}</span>
                        <span v-if="item.tag" class="text-[10px] px-1.5 py-0.5 rounded bg-gray-100 text-gray-500 font-bold">{{ item.tag }}</span>
                    </div>
                    
                    <h3 class="font-bold text-gray-800 text-base leading-tight">{{ item.location }}</h3>
                    <p v-if="item.desc" class="text-sm text-gray-500 mt-1 leading-relaxed">{{ item.desc }}</p>
                    <p v-if="item.warning" class="text-xs text-red-500 mt-1 font-bold bg-red-50 p-1 rounded inline-block">âš ï¸ {{ item.warning }}</p>
                    
                    <!-- æŒ‰éˆ•ç¾¤çµ„ -->
                    <div class="mt-3 flex gap-2">
                        <!-- åœ°åœ–æŒ‰éˆ• (åŒæ™‚æ”¯æ´é»æ“Šè·³è½‰Appèˆ‡åœ°åœ–èšç„¦) -->
                        <button v-if="item.coords" 
                                @click="handleMapClick(item.coords, item.location)" 
                                class="flex-1 bg-blue-50 text-blue-700 border border-blue-100 py-2 rounded-lg text-xs font-bold active:bg-blue-100 transition shadow-sm flex justify-center items-center gap-1">
                            ğŸ“ å°èˆª/åœ°åœ–
                        </button>
                        
                        <a v-if="item.searchLink" :href="item.searchLink" target="_blank" 
                           class="flex-1 bg-white text-gray-600 border border-gray-200 py-2 rounded-lg text-xs font-bold active:bg-gray-50 transition shadow-sm flex justify-center items-center gap-1">
                           ğŸ” Google
                        </a>

                        <a v-if="item.officialLink" :href="item.officialLink" target="_blank" 
                           class="flex-1 bg-amber-50 text-amber-700 border border-amber-200 py-2 rounded-lg text-xs font-bold active:bg-amber-100 transition shadow-sm flex justify-center items-center gap-1">
                           ğŸ¨ å®˜ç¶²
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- å³å´ (æ‰‹æ©Ÿç‚ºä¸Šå´)ï¼šåœ°åœ– -->
        <div class="map-section w-full relative bg-gray-200">
            <div id="map" class="w-full h-full outline-none"></div>
            <!-- åœ°åœ–è¦†è“‹æ§åˆ¶é … -->
            <div class="absolute bottom-2 right-2 z-[400] bg-white/80 px-1 text-[10px] text-gray-500 rounded pointer-events-none">
                 Â© OSM
            </div>
        </div>

    </div>

    <script>
        const { createApp, ref, onMounted, watch } = Vue;

        createApp({
            setup() {
                const currentDay = ref(0);
                let map = null;
                let markers = [];

                // è¡Œç¨‹è³‡æ–™åº« (å®Œæ•´è³‡æ–™)
                const itinerary = ref([
                    {
                        title: "Day 1 (1/31)",
                        shortTitle: "D1 æ©Ÿå ´/ç†±æµ·",
                        summary: "è¶•è·¯åƒæµ·é®®ï¼Œå…¥ä½ç†±æµ·ã€‚æµ·è€åSAåªè²·éºµåŒ…ä¸åƒæ­£é¤ã€‚",
                        events: [
                            { time: "15:55", location: "æˆç”°æ©Ÿå ´ (NRT)", tag: "æŠµé”", desc: "å¿«é€Ÿé€šé—œã€é ˜è¡Œæã€å–è»Š (è¨­å®šETC/å°èˆª)ã€‚", coords: [35.7719, 140.3929] },
                            { time: "18:30", location: "æµ·è€å SA", tag: "ä¼‘æ¯", highlight: true, warning: "åªè²·éºµåŒ…ï¼Œè¶•è·¯è¦ç·Š", desc: "åªä¸Šå»æ‰€ + è²·å“ˆå¯†ç“œéºµåŒ…å¢Šèƒƒã€‚", coords: [35.4549, 139.3888] },
                            { time: "20:00", location: "ä¼Šè±†å¤ªéƒ (ç†±æµ· Lasca 3F)", tag: "æ™šé¤é¦–é¸", desc: "ä¸ç”¨æ’éšŠç›´æ¥é€²å»åƒæµ·é®®ä¸¼/å£½å¸ã€‚", searchLink: "https://www.google.com/search?q=ä¼Šè±†å¤ªéƒ+ãƒ©ã‚¹ã‚«ç†±æµ·", coords: [35.1036, 139.0777] },
                            { time: "20:00", location: "Leone 9", tag: "æ™šé¤æ¬¡é¸", desc: "æ°£æ°›ä½³ï¼Œå‰ææ˜¯å·²è¨‚ä½ã€‚", searchLink: "https://www.google.com/search?q=Leone+9+Atami", coords: [35.0990, 139.0730] },
                            { time: "21:45", location: "ç†±æµ·æ¸©æ³‰ å®Ÿã®åˆ¥è˜", tag: "ä½å®¿", desc: "Check-inã€‚è¨˜å¾—æå‰å‘ŠçŸ¥æ™šåˆ°ã€‚", officialLink: "https://www.booking.com/hotel/jp/re-hai-wen-quan-shi-nobie-zhuang.ja.html", coords: [35.1042, 139.0655] }
                        ]
                    },
                    {
                        title: "Day 2 (2/1)",
                        shortTitle: "D2 ç†±æµ·/ä¼Šè±†",
                        summary: "ä¸Šåˆæ¢…åœ’ï¼Œä¸‹åˆå¤§å®¤å±±çºœè»Š(16:00æœ«ç­)ã€‚æ™šä¸Šä½èµ¤æ¾¤ã€‚",
                        events: [
                            { time: "10:10", location: "ä¾†å®®ç¥ç¤¾", tag: "æ™¯é»", desc: "ç¹å¤§æ¥ ç¥æœ¨ä¸€åœˆå»¶å£½ã€‚", searchLink: "https://www.google.com/search?q=ä¾†å®®ç¥ç¤¾+ç†±æµ·", coords: [35.0997, 139.0664] },
                            { time: "10:50", location: "ç†±æµ·æ¢…åœ’", tag: "æ™¯é»", desc: "æ¢…èŠ±ç¥­ï¼Œåœ’å…§ 472 æ£µæ¢…æ¨¹ã€‚", coords: [35.0945, 139.0635] },
                            { time: "11:40", location: "Panju Kuon", tag: "é»å¿ƒ", desc: "å¿…è²·æ ¸æ¡ƒéºµåŒ…è»Šä¸Šåƒã€‚", searchLink: "https://www.google.com/search?q=ãƒ‘ãƒ³æ¨¹+ä¹…é +ç†±æµ·", coords: [35.098, 139.072] },
                            { time: "12:05", location: "ç†±æµ·åŸ (å¤–è§€)", tag: "æ‰“å¡", desc: "ä¸é€²åŸï¼Œé–€å£æ‹å…¨æ™¯ã€‚", coords: [35.0854, 139.0782] },
                            { time: "13:20", location: "å›è»¢å¯¿å¸ é­šç£¯", tag: "åˆé¤", desc: "ä¼Šè±†é«˜åŸåº—ã€‚å¿…é»é‡‘ç›®é¯›ã€‚", searchLink: "https://www.google.com/search?q=å›è»¢å¯¿å¸+é­šç£¯+ä¼Šè±†é«˜åŸ", coords: [34.908, 139.105] },
                            { time: "15:00", location: "å¤§å®¤å±± (çºœè»Š)", tag: "é‡é»", highlight: true, warning: "16:00 æœ«ç­è»Š", desc: "å±±é ‚ç¹ç«å±±å£æ­¥é“ã€‚", searchLink: "https://www.google.com/search?q=å¤§å®¤å±±", coords: [34.9026, 139.0961] },
                            { time: "16:30", location: "åŸå´æµ·å²¸", tag: "æ™¯é»", desc: "é–€è„‡åŠæ©‹çœ‹å¤•é™½ã€‚", coords: [34.8878, 139.1368] },
                            { time: "17:40", location: "æœ¬å®¶ é®ªå±‹", tag: "æ™šé¤", desc: "é‡‘ç›®é¯›ç…®ä»˜å®šé£Ÿã€‚", searchLink: "https://www.google.com/search?q=æœ¬å®¶+é®ªå±‹+ä¼Šè±†é«˜åŸ", coords: [34.8817, 139.1065] },
                            { time: "19:15", location: "èµ¤æ¾¤æº«æ³‰é£¯åº—", tag: "ä½å®¿", desc: "å¿…å» DHC èµ¤æ¾¤æ—¥æ­¸æº«æ³‰é¤¨ã€‚", officialLink: "https://www.izuakazawa.jp/stay/onsen-hotel/", coords: [34.8569, 139.0936] }
                        ]
                    },
                    {
                        title: "Day 3 (2/2)",
                        shortTitle: "D3 æ²³æ´¥/ç®±æ ¹",
                        summary: "æ²³æ´¥æ«» & ç®±æ ¹çµ•æ™¯ã€‚èµ°ä¼Šè±† Skyline é¿é–‹å¡è»Šã€‚",
                        events: [
                            { time: "10:00", location: "æ²³æ´¥æ«»", tag: "è³æ«»", desc: "æ²³é‚Šæ•£æ­¥ã€åƒæ”¤è²©å°åƒã€‚", searchLink: "https://www.google.com/search?q=æ²³æ´¥æ¡œã¾ã¤ã‚Š", coords: [34.7476, 138.9972] },
                            { time: "11:30", location: "ä¼Šè±† Skyline", tag: "è»ŠéŠ", desc: "çœ‹æµ·çœ‹å¯Œå£«å±±ï¼Œç›´å¥”å¤§æ¶Œè°·ã€‚", coords: [34.9926, 139.0286] },
                            { time: "13:00", location: "å¤§æ¶Œè°·", tag: "æ™¯é»", desc: "åƒé»‘è›‹å»¶å£½ã€‚", coords: [35.2425, 139.0195] },
                            { time: "15:20", location: "ç®±æ ¹æµ·è³Šèˆ¹", tag: "é«”é©—", desc: "æ¡ƒæºå°æ¸¯ -> å…ƒç®±æ ¹æ¸¯ã€‚", searchLink: "https://www.google.com/search?q=ç®±æ ¹æµ·è³Šèˆ¹+æ™‚åˆ»è¡¨", coords: [35.2384, 138.9942] },
                            { time: "16:00", location: "ç®±æ ¹ç¥ç¤¾", tag: "æ‰“å¡", desc: "å¹³å’Œé³¥å±…ã€‚", coords: [35.2046, 139.0252] },
                            { time: "17:30", location: "ç®±æ ¹æ¹¯ä¹‹èŠ±ç‹å­", tag: "ä½å®¿", desc: "éœ²å¤©æº«æ³‰ã€‚", officialLink: "https://www.princehotels.co.jp/yunohana/", coords: [35.2158, 139.0411] }
                        ]
                    },
                    {
                        title: "Day 4 (2/3)",
                        shortTitle: "D4 ç¾è¡“é¤¨/æ±äº¬",
                        summary: "ç¾è¡“é¤¨æ–‡è—ä¹‹æ—… & è¿”å›æ±äº¬ã€‚æ™šé¤æƒ æ¯”å£½ã€‚",
                        events: [
                            { time: "10:00", location: "é›•åˆ»ä¹‹æ£®ç¾è¡“é¤¨", tag: "æ–‡è—", desc: "ç•¢å¡ç´¢é¤¨ã€æˆ¶å¤–è¶³æ¹¯ã€‚", searchLink: "https://www.hakone-oam.or.jp/", coords: [35.2447, 139.0514] },
                            { time: "12:30", location: "ç”°ã‚€ã‚‰éŠ€ã‹ã¤äº­", tag: "åˆé¤", desc: "å¼·ç¾…è±†è…è±¬æ’ååº—ã€‚", searchLink: "https://www.google.com/search?q=ç”°ã‚€ã‚‰éŠ€ã‹ã¤äº­", coords: [35.2505, 139.0483] },
                            { time: "13:45", location: "è¿”å›æ±äº¬", tag: "ç§»å‹•", desc: "é †åˆ©å¯å»ä»£å®˜å±±è”¦å±‹ã€‚", coords: [35.6480, 139.7020] },
                            { time: "17:00", location: "æµæ¯”å¯¿ é®¨ ã¯ã¤ã‚", tag: "æ™šé¤", desc: "æº–æ™‚äº«ç”¨ç¾é£Ÿã€‚", searchLink: "https://www.google.com/search?q=æµæ¯”å¯¿+é®¨+ã¯ã¤ã‚", coords: [35.6467, 139.7101] }
                        ]
                    },
                    {
                        title: "Day 5 (2/4)",
                        shortTitle: "D5 é°»é­šé£¯/æ©Ÿå ´",
                        summary: "é ‚ç´šé°»é­šé£¯ & æ©Ÿå ´é€åˆ¥ã€‚å®Œç¾æ”¶å°¾ã€‚",
                        events: [
                            { time: "11:00", location: "ã†ãªå¯Œå£« æœ‰æ¥½ç”º", tag: "åˆé¤", desc: "åå¤å±‹æµé°»é­šé£¯ã€‚", searchLink: "https://www.google.com/search?q=ç‚­ç„¼+ã†ãªå¯Œå£«+æœ‰æ¥½ç”ºåº—", coords: [35.6738, 139.7594] },
                            { time: "12:30", location: "å‰å¾€æˆç”°æ©Ÿå ´", tag: "ç§»å‹•", desc: "ç¶“é¦–éƒ½é«˜/æ±é—œæ±é“ã€‚", coords: [35.7000, 139.9000] },
                            { time: "13:45", location: "æˆç”°æ©Ÿå ´ (é€æ©Ÿ)", tag: "é€åˆ¥", desc: "T2/T1ã€‚", coords: [35.7719, 140.3929] },
                            { time: "14:30", location: "é‚„è»Š & Check-in", tag: "çµæŸ", desc: "16:55 èˆªç­çµ„ã€‚", coords: [35.7750, 140.3850] }
                        ]
                    }
                ]);

                // åˆå§‹åŒ–åœ°åœ– (ä½¿ç”¨ cartocdn ç¢ºä¿ç©©å®š)
                const initMap = () => {
                    map = L.map('map', {zoomControl: false}).setView([35.1036, 139.0777], 10);
// æ¨è–¦æ”¹ç”¨é€™å€‹ï¼Œæœ€ç©©
L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
    maxZoom: 19
}).addTo(map);

                    updateMarkers(0);
                };

                // æ›´æ–°åœ°åœ–æ¨™è¨˜
                const updateMarkers = (dayIndex) => {
                    if (!map) return;
                    // æ¸…é™¤èˆŠæ¨™è¨˜
                    markers.forEach(m => map.removeLayer(m));
                    markers = [];
                    
                    const events = itinerary.value[dayIndex].events;
                    const bounds = [];

                    events.forEach((event, i) => {
                        if (event.coords) {
                            // è‡ªè¨‚æ¨™è¨˜æ¨£å¼
                            const color = event.highlight ? '#EF4444' : '#2563EB';
                            const icon = L.divIcon({
                                className: '',
                                html: `<div style="background-color:${color};color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;border:2px solid white;box-shadow:0 2px 4px rgba(0,0,0,0.3)">${i+1}</div>`,
                                iconSize: [24, 24]
                            });

                            const marker = L.marker(event.coords, {icon: icon}).addTo(map)
                                .bindPopup(`<div style="text-align:center"><b>${event.location}</b><br><span style="font-size:0.8em">${event.time}</span></div>`);
                            markers.push(marker);
                            bounds.push(event.coords);
                        }
                    });

                    if (bounds.length > 0) {
                        map.fitBounds(bounds, { padding: [50, 50] });
                    }
                };

                // è™•ç†åœ°åœ–æŒ‰éˆ•é»æ“Š (å¦‚æœæ˜¯æ‰‹æ©Ÿï¼Œå˜—è©¦é–‹å•Ÿ Google Maps Appï¼›å¦‚æœæ˜¯é›»è…¦æˆ–åµŒå…¥ï¼Œç§»å‹•åœ°åœ–)
                const handleMapClick = (coords, location) => {
                    // 1. å…ˆåœ¨åœ°åœ–ä¸Šèšç„¦
                    if(map) {
                        map.setView(coords, 14);
                        L.popup().setLatLng(coords).setContent(`<b>${location}</b>`).openOn(map);
                    }
                    
                    // 2. å¦‚æœæ˜¯æ‰‹æ©Ÿå°ºå¯¸ï¼Œä¹Ÿå¯ä»¥è€ƒæ…®ç›´æ¥é–‹ App (é€™è£¡åšæˆé›™é‡åŠŸèƒ½ï¼šèšç„¦ + æº–å‚™å°èˆªé€£çµ)
                    // é€™è£¡çš„é‚è¼¯æ˜¯ï¼šä½¿ç”¨è€…é»æ“Šå¾Œï¼Œè¦–åœ–æœƒç§»å‹•ã€‚å¦‚æœä»–å€‘çœŸçš„è¦å°èˆªï¼Œå¯ä»¥é•·æŒ‰æˆ–å†æ¬¡é»æ“Š
                    // ç‚ºäº†ç°¡åŒ–ï¼Œæˆ‘å€‘å…ˆåªåšè¦–åœ–ç§»å‹•ã€‚å¦‚æœéœ€è¦å¤–é€£ï¼Œå¯ä»¥å†åŠ ã€‚
                };

                watch(currentDay, (newDay) => {
                    updateMarkers(newDay);
                    // åˆ‡æ›å¤©æ•¸æ™‚ï¼Œåˆ—è¡¨æ²å›é ‚éƒ¨
                    const container = document.querySelector('.events-container');
                    if(container) container.scrollTop = 0;
                });

                onMounted(() => {
                    // å»¶é²è¼‰å…¥åœ°åœ–ä»¥é¿å…å®¹å™¨å¤§å°å°šæœªç¢ºå®šçš„å•é¡Œ
                    setTimeout(initMap, 100);
                });

                return {
                    currentDay,
                    itinerary,
                    handleMapClick
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
